<html>
  <head>
    <meta name="generator"
    content="HTML Tidy for HTML5 (experimental) for Windows https://github.com/w3c/tidy-html5/tree/c63cc39" />
    <title></title>
    <script type="text/javascript" src="node_modules/trkl/trkl-min.js"></script>
  </head>
  <body>
    <div id="app">
    </div>
  </body>
  
    <script>
    'use strict';
    var element = document.getElementById('app');
    
    let string = trkl('Hello World');
    let button = trkl('<button onclick="addToList()">add</button><ul>');
       
    let models = trkl([
        { prop: trkl('John Doe')},
        { prop: trkl('Amy Doe')},
        { prop: trkl('3rd Doe')}        
    ]);
    
    let list = function () {
    
    return  button()+  
            models().map(
                function(obj, index){
                    return '<li>'+obj.prop()+'</li><button onclick="updateModel('+index+')">test</button>';
                }
            ).join(" ");
            +'</ul>';
    }   
    
    let view = trkl.computed(()=> {
        return '<h1>'+string()+'</h1><br/>'+list();
    });
    
    view.subscribe((newVal, oldVal) => {
        refresh();
    });      
    
    function updateModel(index){
        models()[index].prop('updated Doe');
    }
    
    function addToList(){
        var arr = models();
        arr.push({prop: trkl('new doe')});
        models(
            arr
        );

    }
    
    function refresh(){
        console.time("view");
        element.innerHTML = view();
        console.timeEnd("view");
    }
      
    refresh();
    
    
    </script>
    
</html>
